<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>role</title>
    <link rel="stylesheet" href="{CSS_URL}/bootstrap.min.css">
    <script src="{JS_URL}/jquery-3.2.1.min.js"></script>
</head>
<style>
    .container{
        width: 90%;margin: 30px auto 0;
    }
</style>
<body>
    <div class="container">
        <table class="table table-striped table-bordered table-hover">
            <tr>
                <th>id</th>
                <th>名称</th>
            </tr>
            {foreach $result as $value}
                <tr>
                    {foreach $value as $val}
                        <td>{$val}</td>
                    {/foreach}
                </tr>
            {/foreach}
        </table>
    </div>
    <script>
        $(document).ready(function () {
            let tableH = $("table").outerHeight();
            let screenH = $(window).height();
            let num = 0;
            let flag = true;
            $(window).scroll(function () {
                let scrollH = $(window).scrollTop();
                if (scrollH + screenH >= tableH){
                    if (!flag){
                        return 0;
                    }
                    flag = false;
                    num++;
                    $.ajax({
                        url:"index.php?m=admin&f=user&a=ajax",
                        data:{ page:num },
                        type:"post",
                        dataType:"json",
                        success:function (e) {
                            for (let i = 0; i < e.length; i++){
                                $("<tr><td>"+e[i].rid+"</td><td>"+e[i].rname+"</td></tr>").appendTo("tbody");
                            }
                            flag = true;
                        }
                    })
                }
            })
        })
    </script>
</body>
</html>