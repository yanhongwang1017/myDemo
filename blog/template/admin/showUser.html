<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户查看</title>
    <link rel="stylesheet" href="{CSS_URL}/bootstrap.min.css">
    <script src="{JS_URL}/jquery-3.2.1.min.js"></script>
    <script src="{STATIC_URL}/layui/layui.js"></script>
</head>
<style>
    .table-responsive{
        width: 90%;  margin: 0 auto;
    }
    caption h2{
        text-align: center;  color: #0e0e0e;
    }
    th,td{
        text-align: center;
    }
    .table>tbody>tr>td, .table>tbody>tr>th{
        vertical-align: middle;font-size: 18px;
    }
</style>
<body>
    <div class="table-responsive">
        <table class="table table-striped table-bordered table-hover table-condensed">
            <caption><h2>用户信息列表</h2></caption>
            <tr>
                <th>编号</th>
                <th>头像</th>
                <th>姓名</th>
                <th>昵称</th>
                <th>等级</th>
                <th>联系方式</th>
                <th>注册日期</th>
                <th>操作</th>
            </tr>
            {foreach $result as $value}
                <tr>
                    <td>{$value["uid"]}</td>
                    <td>{$value["photo"]}</td>
                    <td>{$value["uname"]}</td>
                    <td>{$value["nicheng"]}</td>
                    <td>{$value["rname"]}</td>
                    <td>{$value["phone"]}</td>
                    <td>{$value["regdate"]}</td>
                    <td>
                        <button class="btn btn-danger" attr="{$value['uid']}">删除</button>
                    </td>
                </tr>
            {/foreach}
        </table>
    </div>
    <script>
        $(function () {
            layui.use('layer',function () {
                var layer = layui.layer;
                $(".btn-danger").on("click",function () {
                    let that = $(this);
                    let uid = that.attr("attr");
                    layer.confirm('确定删除该用户吗？', {
                        btn: ['确定','取消']
                    }, function(){
                        $.ajax({
                            url:"index.php?m=admin&f=user&a=delUser&uid="+uid,
                            success:function (e) {
                                console.log(e);
                                if (e == "ok"){
                                    that.parent().parent().remove();
                                    layer.msg('删除成功');
                                }else if (e == "no"){
                                    layer.msg('您没有该权限');
                                }
                            }
                        })
                    });
                })
            })
        })
    </script>
</body>
</html>